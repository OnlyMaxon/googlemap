<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ä—Ç–∞ –º–∏—Ä–∞ ‚Äî –≤—Å–µ —Å—Ç—Ä–∞–Ω—ã (–±–µ–∑ Google)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { width: 100%; height: 100%; font-family: Arial, sans-serif; }
        #map { width: 100%; height: 100%; }
        .info-panel {
            position: absolute; top: 10px; left: 10px; background: #fff; padding: 12px 14px;
            border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.3); z-index: 1000; max-width: 280px;
        }
        .info-panel h2 { font-size: 16px; margin-bottom: 6px; color: #333; }
        .info-panel p { font-size: 13px; color: #666; margin: 4px 0; }
        .error-banner { position: absolute; left: 50%; bottom: 16px; transform: translateX(-50%);
            background: #ffe8e8; color: #b00020; border: 1px solid #ffb3b3; padding: 8px 12px; border-radius: 6px;
            z-index: 1200; font-size: 13px; display: none; }
    </style>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
</head>
<body>
    <div class="info-panel">
        <h2>–ö–∞—Ä—Ç–∞ –º–∏—Ä–∞</h2>
        <p>üó∫Ô∏è –í—Å–µ —Å—Ç—Ä–∞–Ω—ã, –±–µ–∑ Google</p>
        <p>üîç –¢–µ–∫—É—â–∏–π –∑—É–º: <span id="zoom-level">‚Äî</span></p>
        <p>–ü–æ–¥—Å–∫–∞–∑–∫–∞: –∫–æ–ª–µ—Å–æ –º—ã—à–∏ ‚Äî –∑—É–º; –∫–ª–∏–∫ –ø–æ —Å—Ç—Ä–∞–Ω–µ ‚Äî –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å</p>
    </div>

    <div id="map"></div>
    <div class="error-banner" id="error-banner"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        const COUNTRIES_GEOJSON_URL = 'https://raw.githubusercontent.com/datasets/geo-countries/master/data/countries.geojson';

        const map = L.map('map', { worldCopyJump: true, zoomSnap: 0.5, zoomDelta: 0.5 }).setView([20, 0], 2);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        const zoomLabel = document.getElementById('zoom-level');
        function updateZoomLabel() { zoomLabel.textContent = map.getZoom().toFixed(1) + 'x'; }
        map.on('zoomend', updateZoomLabel); updateZoomLabel();

        const defaultStyle = { color: '#1e88e5', weight: 1.5, opacity: 1, fillColor: '#bbdefb', fillOpacity: 0.35 };
        const highlightStyle = { weight: 2.5, color: '#0d47a1', fillColor: '#90caf9', fillOpacity: 0.55 };
        let countriesLayer;

        function getCountryName(props) {
            return props?.ADMIN || props?.NAME || props?.name || props?.ADMIN_NAME || props?.COUNTRY || '–°—Ç—Ä–∞–Ω–∞';
        }

        function onEachFeature(feature, layer) {
            const name = getCountryName(feature.properties || {});
            layer.bindTooltip(name, { sticky: true, direction: 'center', className: 'country-label' });
            layer.on({
                mouseover: (e) => e.target.setStyle(highlightStyle),
                mouseout: (e) => countriesLayer.resetStyle(e.target),
                click: (e) => map.fitBounds(e.target.getBounds(), { padding: [20, 20] })
            });
        }

        fetch(COUNTRIES_GEOJSON_URL)
            .then(r => { if (!r.ok) throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã —Å—Ç—Ä–∞–Ω'); return r.json(); })
            .then(geojson => {
                countriesLayer = L.geoJSON(geojson, { style: () => defaultStyle, onEachFeature }).addTo(map);
                try { map.fitBounds(countriesLayer.getBounds(), { padding: [20, 20] }); } catch (_) {}
            })
            .catch(err => {
                const banner = document.getElementById('error-banner');
                banner.textContent = '–û—à–∏–±–∫–∞: ' + err.message;
                banner.style.display = 'block';
            });
    </script>
</body>
</html>
